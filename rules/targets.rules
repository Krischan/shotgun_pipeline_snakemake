####################
## SAMPLE IDS with PCMP prefix
####################
SAMPLE_IDS = get_sample_ids_from_barcode(config["barcodes"])
SAMPLE_IDS = ["PCMP_" + s for s in SAMPLE_IDS]


####################
## demultiplex + QC
####################

TARGET_FPS1 = expand(config["output"]["dnabc"] + "/{sample_id}_{read}.fastq", sample_id=SAMPLE_IDS, read=["R1","R2"])

TARGET_FPS2 = expand(config["output"]["illqc"] + "/{sample_id}_{read}.fastq", sample_id=SAMPLE_IDS, read=["R1","R2"])

TARGET_FPS3 = expand(config["output"]["stitch"] + "/{sample_id}.{type}.fastq",sample_id=SAMPLE_IDS, type=["assembled","discarded","unassembled.forward","unassembled.reverse"])

####################
## decontam
####################
TARGET_FPS4 = expand(config["output"]["decontam_host_assembled"] + "/{sample_id}.assembled.fastq",sample_id=SAMPLE_IDS)
TARGET_FPS5 = expand(config["output"]["decontam_host_unassembled"] + "/{sample_id}.{type}.fastq",sample_id=SAMPLE_IDS, type=["unassembled.forward","unassembled.reverse"])


####################
## kraken classify
####################
TARGET_FPS6 = expand(config["output"]["kraken_classify_unassembled"] + "/{sample_id}.taxa.tsv", sample_id=SAMPLE_IDS)
TARGET_FPS7 = expand(config["output"]["kraken_classify_assembled"] + "/{sample_id}.taxa.tsv", sample_id=SAMPLE_IDS)
TARGET_FPS8 = expand(config["output"]["kraken_classify_unassembled"]+
"/{sample_id}.mpa.tsv", sample_id=SAMPLE_IDS)
TARGET_FPS9 = expand(config["output"]["kraken_classify_assembled"]+
"/{sample_id}.mpa.tsv", sample_id=SAMPLE_IDS)

TARGET_KRAKEN = TARGET_FPS8 + TARGET_FPS9 

TARGET_TSV = ["preprocess_summary.tsv"]

rule make_decontam:
	input: TARGET_FPS4 + TARGET_FPS5

TARGET_FPS = TARGET_KRAKEN
